<!DOCTYPE html>
<html lang="es">
<head>
<link rel="stylesheet" href="style.css">
    <meta charset="UTF-8">
    <title>Espermatogénesis</title>


<script src="https://aframe.io/releases/1.6.0/aframe.min.js"></script>
<script src="https://raw.githack.com/AR-js-org/AR.js/master/aframe/build/aframe-ar.js"></script>
<script src="https://cdn.jsdelivr.net/npm/aframe-extras@7.0.0/dist/aframe-extras.min.js"></script>
<script src="https://cdn.jsdelivr.net/gh/fcor/arjs-gestures@master/gesture-detector.js"></script>
<script src="https://cdn.jsdelivr.net/gh/fcor/arjs-gestures@master/gesture-handler.js"></script>
<!--<script type="module" src="https://ajax.googleapis.com/ajax/libs/model-viewer/1.12.0/model-viewer.min.js"></script> Son librerias para que funcione lo de los modelos en la parte del model viewer-->
<script type="module" src="https://unpkg.com/@google/model-viewer/dist/model-viewer.min.js"></script>

</head>
<body>

<div id="info">
<div class="titulo-con-imagenes">
<h1>Espermatogénesis</h1>
<img src="https://github.com/KelvinRiv/Proyecto/blob/main/imagenes/Marca%20de%20agua%20museo.png?raw=true" alt="Marca de agua museo">
</div>
<h2>Museo de Embriología</h2>
        <h3>Universidad Autónoma de Chihuahua</h3>
        <p>La embriología es el estudio del desarrollo de un embrión desde la fecundación del óvulo hasta la octava semana de gestación. Este campo científico es fundamental para comprender cómo se forman los organismos y las estructuras celulares básicas que dan origen a la vida.</p>
        <p>Con esta aplicación usted podrá obtener una experiencia de realidad aumentada donde podrá ver modelos 3D animados de la espermatogénesis. Simplemente inicie la cámara y apunte al marcador Hiro para visualizar el contenido.</p>
  <div id="menu-modelos">
<h3>Si desea una experiencia inmersiva en la embriología da click en el botón de abajo</h3>
    <button data-model="testiculo"> Experiencia AR </button>
  </div>
</div>

<div id="modal-modelo" class="modal">
  <div class="modal-content">
    <h2 id="modal-titulo"></h2>
    <p id="modal-descripcion"></p>
    <button id="start-ar">Iniciar Realidad Aumentada</button>
    <button id="cerrar-modal">Cerrar</button>
  </div>
</div>

<div class="hamburger-menu">
    <input id="menu__ham" type="checkbox" />
    <label class="menu__btn" for="menu__ham">
      <span></span>
    </label>

    <ul class="menu__box">
      <li><a class="menu__item" href="#" id="redsem-btn">Red Seminifera</a></li>
      <li><a class="menu__item" href="#" id="esp-btn">Espermatogénesis</a></li>
      <li><a class="menu__item" href="#">Animación</a></li>
    </ul>
</div>

  <div id="redsem-moda" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.8); z-index: 1000; justify-content: center; align-items: center;">
    <div style="background: rgb(218, 218, 218); padding: 20px; width: 80%; height: 80%;">
    <model-viewer
    src="https://raw.githubusercontent.com/KelvinRiv/Proyecto/main/RedSeminifera.glb" 
    alt="RedSeminifera"
    camera-controls
    shadow-intensity = "1"
    style="width: 100%; height: 90%;"
    >
    </model-viewer>
    <button id="cerrar-redsem-btn">Cerrar</button>
    </div>
</div>
  <div id="esp-moda" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.8); z-index: 1000; justify-content: center; align-items: center;">
    <div style="background: rgb(0, 0, 0); padding: 20px; width: 80%; height: 80%;">
    <ModelViewerElement
    autoplay  
    src="https://raw.githubusercontent.com/KelvinRiv/Proyecto/main/Espermatogenesis.glb" 
    alt="Espermatogenesis"
    camera-controls
    shadow-intensity = "1"
    style="width: 100%; height: 90%;"
    >
    </ModelViewerElement>
    <button id="cerrar-esp-btn">Cerrar</button>
    </div>
</div>


    <button id="exit-ar">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
      <path d="M18.3 5.71a1 1 0 0 0-1.42 0L12 10.59 7.11 5.7a1 1 0 0 0-1.42 1.42L10.59 12l-4.9 4.89a1 1 0 0 0 1.42 1.42L12 13.41l4.89 4.9a1 1 0 0 0 1.42-1.42L13.41 12l4.89-4.89a1 1 0 0 0 0-1.4z"/>
    </svg>
    Salir
  </button>

    <div id="ar-container"></div>

<script>
    const info = document.getElementById('info');
    const arContainer = document.getElementById('ar-container');
    const exitBtn = document.getElementById('exit-ar');

    const menubtn = document.getElementsByClassName('menu__btn')
    const menu__btn = menubtn[0]
    
  // Modal
    const modal = document.getElementById('modal-modelo');
    const modalTitulo = document.getElementById('modal-titulo');
    const modalDescripcion = document.getElementById('modal-descripcion');
    const startBtn = document.getElementById('start-ar');
    const cerrarModal = document.getElementById('cerrar-modal');


  // Información de cada modelo
  const modelosInfo = {
    testiculo: {
      titulo: "Modelos de espermatogénesis",
      descripcion: 'Al hacer click en el botón de "Iniciar Realidad aumentada", se abrira una nueva pestaña donde necesitaremos que nos permitas acceder a tu cámara y que aceptes otros permisos, asegurate de aceptarlos para que todo funcione correctamente, en caso de no aceptarlos, puedes presionar el botón de salir y volver a la página de inicio. No nos quedamos con ningun dato de los usuarios, todo se borra al salir de la página'
    }
  };
    const abrirBtn = document.getElementById('redsem-btn');
    const abriresp = document.getElementById('esp-btn');
    const cerrarBtn = document.getElementById('cerrar-redsem-btn');
    const cerraresp = document.getElementById('cerrar-esp-btn');
    const moda = document.getElementById('redsem-moda');
    const modalesp = document.getElementById('esp-moda');

    abrirBtn.addEventListener('click', (e) => {
        e.preventDefault(); 
        
        moda.style.display = 'flex'; 
  });
    abriresp.addEventListener('click', (e) => {
        e.preventDefault(); 
        
        modalesp.style.display = 'flex'; 
  });
    cerrarBtn.addEventListener('click', () => {
        moda.style.display = 'none'; 
  });
    cerraresp.addEventListener('click', () => {
        modalesp.style.display = 'none'; 
  });
  // Cuando se da clic en un modelo
  document.querySelectorAll('#menu-modelos button').forEach(btn => {
    btn.addEventListener('click', () => {
      const modelKey = btn.getAttribute('data-model');
      const modelData = modelosInfo[modelKey];
      modalTitulo.textContent = modelData.titulo;
      modalDescripcion.textContent = modelData.descripcion;
      modal.style.display = 'flex';

      // Guardar modelo elegido
      startBtn.dataset.model = modelKey;
    });
});


  // Cerrar modal
  cerrarModal.addEventListener('click', () => {
    modal.style.display = 'none';
  });


  // Iniciar AR al presionar el botón del modal
  startBtn.addEventListener('click', () => {
    modal.style.display = 'none';
    info.style.display = 'none';
    exitBtn.style.display = 'flex';
    arContainer.style.display = 'block';

    menu__btn.classList.add('active');

    const modelKey = startBtn.dataset.model;


    // Crear la escena AR (código existente)
    const scene = document.createElement('a-scene');
    scene.setAttribute('embedded', '');
    scene.setAttribute('arjs', '');
    scene.setAttribute('gesture-detector', '');

    // Seleccionar modelo según el elegido
    let marker = document.createElement('a-marker');
    let model = document.createElement('a-entity');

    if (modelKey === "testiculo") {
      marker.setAttribute('preset', 'hiro');
      model.setAttribute('gltf-model', 'embriologia/transparente.glb');
      model.setAttribute('scale', '0.2 0.2 0.2');
      model.setAttribute('rotation', '90 0 180');
    }

    model.setAttribute('gesture-handler', '');
    marker.appendChild(model);
    scene.appendChild(marker);

    const camera = document.createElement('a-entity');
    camera.setAttribute('camera', '');
    scene.appendChild(camera);

    arContainer.innerHTML = '';
    arContainer.appendChild(scene);
  });

  // Botón para salir de AR
  exitBtn.addEventListener('click', () => {
    arContainer.style.display = 'none';
    arContainer.innerHTML = '';
    info.style.display = 'block';
    exitBtn.style.display = 'none';
    menu__btn.classList.remove('active');
    const video = document.querySelector('video');
    if (video && video.srcObject) {
      const stream = video.srcObject;
      const tracks = stream.getTracks();
      tracks.forEach(track => track.stop());
      video.srcObject = null;
    }


        setTimeout(() => { window.location.reload(); }, 300); /*Este script es el que hace que vuelva a la página principal*/
  });
  

</script>


</body>
</html>



